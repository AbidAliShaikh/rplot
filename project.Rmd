Project gss
========================================================
TITLE:
How Attendance to Religious Events are associated with the opinion about sex before marriage.

The data we are dealing with comes from US General Social Survey online http://bit.ly/dasi_gss_data .  The data consists of 57061 observations and 114 variables. The data has been prepared for analysis and includes 99 categorical and 14 integers and one numeric variable. 
The two variables we discuss are attend and premarsx with following levels:
attend: 

[1] "Never"            "Lt Once A Year"   "Once A Year"    
[4] "Sevrl Times A Yr" "Once A Month"     "2-3X A Month"    
[7] "Nrly Every Week"  "Every Week"       "More Thn Once Wk"

premarsx:
[1] "Always Wrong"     "Almst Always Wrg" "Sometimes Wrong" 
[4] "Not Wrong At All" "Other"        

The table below shows that more the attendance to religious events the fewer people believe in pre marriage sex.


```{r}
load("C:/R/Data Analysis and Statistical Inference/Project1/statistics_project_gss.Rdata")
#load(url("http://bit.ly/dasi_gss_data"))
attach(gss)

#install.packages('ggplot2')
#install.packages('gmodels')
#install.packages('vcd')



library(ggplot2)


tabNA <- table(premarsx, attend,useNA='ifany')
tab <- table( attend, premarsx)
ftab <- ftable(tapply(coninc, list(attend, premarsx),mean, na.rm=T))
write.csv(tab, 'tabb.csv')

```


Observing the consistency of the two variables attend variable is more consistent than attend with some years where there is no data at all:


```{r}
barplot(table(attend, year,useNA='ifany' ),las=2,col=(rainbow(10)),legend=c(levels(attend),'NA'),args.legend=list(x='topleft'),cex.names=.7)
```

The years 1973,1976,1980,1984 and 1987 has only NAs. We have to remove NAs accross the two variable dataset that we are now going to subset and then sample:


```{r}
barplot(table(premarsx, year,useNA='ifany' ),las=2,col=(rainbow(6)),legend=c(levels(premarsx),'NA'),args.legend=list(x='topleft'),cex.names=.7)
```

//STATISTICAL ANALYSIS

```{r}

#load("C:/R/Data Analysis and Statistical Inference/Project1/statistics_project_gss.Rdata")
data <-  gss[,c(2,3,8,15,32,92,4,20)]
data <- na.omit(data)

d <- data
#attach(d)

l <- levels(data[,5])
d[,5] <- as.character(d[,5])
d[d$attend=='Once A Year',5] <- '1'
d[d$attend==l[1],5] <-  '130'
d[d$attend == l[2],5] <- '48'
d[d$attend == l[3],5] <- '.5'
d[d$attend == l[4],5] <- '130'
d[d$attend == l[5],5] <- '36'
d[d$attend == l[6],5] <- '12'
d[d$attend == l[8],5] <- '6'

d[,5] <- as.numeric(d[,5])
#d[,5] <- as.factor( ifelse(d[,5] > 20, 'Religious','Not Religious'))
#d[,5] <- as.factor( ifelse(d[,5] > 20, 1,0))
#l2 <- levels(premarsx)

#d[,6] <- as.character(d[,6])
#d[d$premarsx == l2[1],6] <- l2[2]
#d[d$premarsx == l2[4],6] <- l2[3]
#d[,6] <- as.factor(d[,6])

l2 <- levels(data[,6])
d[,6] <- as.character(d[,6])
d[d$premarsx==l2[1],6] <-  'Wrong'
d[d$premarsx==l2[2],6] <-  'Wrong'
d[d$premarsx==l2[3],6] <-  'Not Wrong'
d[d$premarsx==l2[4],6] <-  'Not Wrong'
d <- na.omit(d)
av <- aov(d$attend ~ d$premarsx)
summary (av)


```

GENDER PLAYING A ROLE

```{r}

tab <- CrossTable(attend, premarsx)
tabmale <- d[sex=='Male',]
tabfemale <- d[sex=='Female',]
CrossTable(tabmale$attend, tabmale$premarsx)
CrossTable(tabfemale$attend, tabfemale$premarsx)




```

#PART TWO STATISTICAL ANALYSIS 
To check if number of children play a role; also shown below is dissection on categorical variable attend
```{r}
#load("C:/R/Data Analysis and Statistical Inference/Project1/statistics_project_gss.Rdata")
#detach(d)
# checked if it plays a role year-no, age-no, educ-no, childs-yeah
d <- gss [,c(32,92,20)]
#data <-  gss[,c(2,3,8,15,32,92,4,20)]
d <- na.omit(d)
# we consider cases with 1 to 5 children

d <- d[d$childs <= 5 & d$childs >= 1,]
hist(d$childs)
chisq.test(d$premarsx, d$attend)

# by doing following model the R2 might not be meaninful
# since we are estimating from nominal values of childs
# also a slight change in slopes might be important

model <- lm(d$childs ~ d$attend + d$premarsx)
library(ggplot2)

d[d$attend=='Never',4] <- '0'
d[d$attend=='Lt Once A Year',4] <-  '.5'
d[d$attend == 'Once A Year',4] <- '1'
d[d$attend == 'Sevrl Times A Yr',4] <- '6'
d[d$attend == 'Once A Month',4] <- '12'
d[d$attend == '2-3X A Month',4] <- '30'
d[d$attend == 'Nrly Every Week',4] <- '39'
d[d$attend == 'Every Week',4] <- '52'
d[d$attend == 'More Thn Once Wk',4] <- '130'

d[,4] <- as.numeric(d[,4])

names(d)[4] <- 'Attendance'
ggplot(d, aes(x=d$childs,y=log(d$Attendance) ))+geom_smooth(method='lm')+geom_point(aes(color=d$premarsx, size=5))
  


d[d$Attendance >= 52,5] <- 'Weekly'
d[d$Attendance < 52,5] <- 'Not Weekly'
names(d)[5] <- 'Weekly.or.Not'
d[,5] <- as.factor(d[,5])

weekly_tab <- CrossTable(d$premarsx, d$Weekly.or.Not)

d[d$Attendance >= 30,6] <- 'Monthly'
d[d$Attendance < 30,6] <- 'Not Monthly'
names(d)[6] <- 'Month.Wise'
monthly_tab <- CrossTable(d$premarsx, d$Month.Wise)
# We have almost equal proportions in attendance on monthly basis or less than that, and chisq contributions are almost similar, hence our presumption failed on month-wise and less than month-wise attedance basis. Only the strongest chisq contribution of 1510 came from those who attend more than once wk are against of sex before marriage in the orginal dataset !




```


Mosaic Plot is written in a png file Rplot.png shown below:.

```{r}

load("C:/R/Data Analysis and Statistical Inference/Project1/statistics_project_gss.Rdata")
#detach(d)
# check if it plays a role year-no, age-no, educ-no, childs-yeah
d <- gss [,c(32,92,20,8,15)]
attach(d)
library(gmodels)
tab <- CrossTable(attend, premarsx)
# The highest Chisq contribution is with More than once a week (1510)
chisq.test(tab$t)

# chisq values differ significantly !
#CONCULUSION
# Those who attend more than once a week have said its always wrong


library(vcd)

#png(width=800,height=600)
mosaicplot(tab$t, shade=T, legend=T, las=2, main='Attend Vs premarsx',xlab='Attend events',ylab='Opinion of premarriage sex')
#dev.off()



```
